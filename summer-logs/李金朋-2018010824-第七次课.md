##第七次课

###计算机视觉

+ 计算机视觉就是用计算机代替人眼来做测量和判断
+ 计算机视觉的主要任务包括:分类、定位、检测和分割
+ 识别指标：
  + 精确率(precision)是针对预测结果而言的，它表示的是预测为正的样本中有多少是真正的正样本。
  + 召回率(recall)是针对原来的样本而言的，它表示的是样本中的正例有多少被预测正确了。
  + 准确率(accuracy) 是指对于给定的测试数据集，分类器正确分类的样本数与总样本数 之比。(也就是损失函数是0-1损失时测试数据集上的准确率) 
  + 精确率(precision) = TP/(TP+FP) ——针对预测结果
  + 召回率(recall) = TP/(TP+FN) ——针对样本
  + 准确率(accuracy) = (TP+TN)/(TP+FN+FP+TN) = = 预测对的/所有 ——针对测试数据集
  + 常用的识别精确率指标:
    + 平均精确率均值mAP——不同阈值最大精确度的平均值
    +  PR曲线的覆盖率AUC:P为精确率，R为召回率 
    + 最佳工作状态 ：针对具体应用场景，对精确率和召回率之间进行一个平衡取舍， 从而选择合适的阈值参数，使对象检测器处于最佳的工作状态。 数学含义其实就是精确率P和召回率R的调和平均值

+ 识别算法：

  + IOU（预测框与真实框的重叠联合比）定义了2个边界框( bounding box )(就是恰好框住对象的矩形框)的重叠度，计算为相交面积(∩)/相并面积(∪)

    对于模型给出的检测结果，都会根据以下标准，被判定为其中的 一种: 
     	正确(Correct):类别正确，IOU > 0.5 
         定位错误(Localization):类别正确，0.1 < IOU < 0.5  

    ​     相似性错误(Similar):类别相似，IOU > 0.1 • 其他错误(Other):类别错误，IOU > 0.1
    ​	 背景误认(Background):IOU < 0.1 

  + 滑动框送到卷积网络

  + R-CNN

    + 输入图像，提取提炼区域(region): 

      - 用选择性搜索(selective search)的算法去搜索一个‘fast mode’(快速模式) ，对每一个 

        提出的可能有对象的图像区域提取出一个4096维的特征向量。 

      - 对于不是标准227*227像素的正方形的区域，使其标准化。最简单的方法是膨胀(dilate， 形态学算法)其最小外边框(设宽度=16 pixels)，使整幅图像大小合适。 

    + 计算CNN特征:

      + CNN网络架构: 5个卷积层(Convolution Layers)，2个全连接(Fully Connected 

        Layers), 正如Yann Le Cun之前提出的LeNet算法。 

    + 区域分类: 

    + - 对每一个类预先训练好一个支持向量机(SVM)，然后对之前提炼出来的特征向量 (feature vector)用对应类的SVM去“打分”。 
      - 贪心思想的“非极大值抑制”(non-maximum suppression)算法:如果一个区域和一个有 更高打分的区域有交集(Intersection-over-Union (IoU))并且IoU的值>某个阈值， 那么这个区域(得分相对低的)将被舍弃。 

    + 缺点：训练时间空间开销大；测试时间开销大，速度慢

  + •Fast R-CNN1. 比R-CNN更高的检测质量(mAP);
    • 2. 把多个任务的损失函数写到一起，实现单级的训练过程;
    • 3. 在训练时可更新所有的层;
    • 4. 不需要在磁盘中存储特征。

  + Region Proposal Network (RPN)

  + YOLO算法

    + YOLO算法将对目标检测任务的认识由分类问题(Classification) 化简为回归问题(Regression) 

      在保证精度不过多损失的前提下，极大地提高了检测速度。
      运算速度高，在Titan X GPU上的运行速度可以达到45 FPS(实时) 

    + 流程：1、预处理，检测物体与位置2、用训练好的神经网络进行预测

    + 置信度计算 

      • 置信度(Confidence)综合反映了当前边界框中存在目标的可能性 Pr Object 以及目标位置预测的准确性 IOUtruth 

      • Confidence = Pr Object × IOU（truth，pred） 

  + SSD对象检测

    + 能够在当输入分辨率较低的图像时，保证检测的精度。 
    + 整体端到端(end-to-end)的设计，训练也变得简单。
    + 在检测速度、检测精度之间取得较好的折衷。 